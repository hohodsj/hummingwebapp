<% layout('layouts/boilerplate') %> 
<p>You must be login to see this TODO: Change this to flash later and add edit boiler plate</p>
<div class="row" id="grid-card">
<!-- Hover with text and link example -->
    <p>Showing art works</p>
    <% for(let collection of collections) { %>
        <div class="col-md-6" data-id="<%= collection.order%>">
            <div class="thumbnail"> 
                <img src="<%= collection.cover.thumbnailUrl%>">
                <div class="overlay">
                    <a href="/<%= collection.collectionName%> " class="work-link"  title="Click To View Series">
                        <div class="text">
                            <p class="work-link"><%=collection.collectionName%><br/>
                                <i class="glyphicon glyphicon-th"></i>
                            </p>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    <% } %> 
</div>
<form action="/admin/create-collection" class="fixed-bottom" method="GET">
    <button class="btn btn-success">+</button>
</form>
<form action="/admin/all?_method=DELETE" method="POST" class="position-absolute bottom-0 start-50 translate-middle-x">
    <button type="btn" class="btn btn-danger">Delete All</button>
</form>
<form action="/admin/reorder/portfolio" method="POST" class="">
    <input type="text" id="orders" name="orders" style="display:none">
    <button type="btn" class="btn btn-success" style="display:none" id="save-button">Save</button>
</form>
<script>
    let buttons = document.querySelectorAll('.btn-danger');
    buttons.forEach(button => {
        button.onclick = (event) => confirm(`You are about to delete the collection ${button.value}, do you want to proceed?`);
    })
</script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
<script>
    new Sortable(document.getElementById('grid-card'), {
            group: 'shared',
            animation: 150,
            multiDrag: true,
            selectedClass: 'bg-info',
            fallbackTolerance: 3,
            group: 'storeOrder',
            
            store: {
                set: function(order) {
                    var sortable = order.toArray();
                    console.log(`sortable: ${sortable}`)
                    const orders = document.getElementById('orders');
                    orders.value = sortable.slice(1)
                    document.getElementById('save-button').style.display = "inline";
                }
            }
            
        })
</script>